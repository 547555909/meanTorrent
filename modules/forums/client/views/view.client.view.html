<section ng-controller="ForumsViewController as vm" ng-init="vm.init();">
    <div class="pagetop">
        <div class="container">
            <div class="col-sm-8">
                <div class="page-header">
                    <h2 translate="FORUMS.FORUM_TITLE"></h2>

                    <p class="text-muted" translate="FORUMS.FORUM_SUB_TITLE"></p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="page-header padding-top-10">
                    <div class="input-group">
                        <input type="text" class="form-control" aria-label="search" placeholder="Search">

                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default" aria-label="Search"><span class="glyphicon glyphicon-search"></span>
                            </button>
                        </div>
                    </div>
                    <!--<p class="text-muted margin-top-10">Welcome to meanTorrent forums!</p>-->
                </div>
            </div>
        </div>
    </div>

    <div class="container post-list">
        <div class="path margin-top-20">
            <ol class="breadcrumb">
                <li><a ui-sref="forums.list"><span class="small glyphicon glyphicon-home"></span> {{'FORUMS.HOME_INDEX' | translate}}</a></li>
                <li ng-repeat="p in vm.forumPath" ng-class="{'active': !g.state}">
                    <a ui-sref="{{p.state}}( {{p.params}} )"
                       ng-if="p.state!=undefined">{{p.name}}
                    </a>
                    <span ng-if="p.state==undefined">{{p.name}}</span>
                </li>
            </ol>
        </div>

        <div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="box-uib-and-post-btn">
                        <div class="box-uib">
                            <ul uib-pagination boundary-links="true" max-size="8" items-per-page="vm.itemsPerPage" total-items="vm.filterLength"
                                ng-model="vm.currentPage"
                                ng-change="vm.pageChanged()"
                                first-text="{{ 'PAGE_TEXT_FIRST' | translate}}" previous-text="{{ 'PAGE_TEXT_PREVIOUS' | translate}}"
                                next-text="{{ 'PAGE_TEXT_NEXT' | translate}}" last-text="{{ 'PAGE_TEXT_LAST' | translate}}">
                            </ul>
                        </div>
                        <div class="box-post-btn">
                            <a class="btn btn-success btn-width-100"
                               ng-if="!vm.forum.readOnly || vm.canEdit(vm.forum)"
                               ui-sref="forums.post({forumId: vm.forum._id})">{{'FORUMS.BTN_POST_NEW_TOPIC' | translate}}</a>
                            <h5 class="text-danger text-uppercase" translate="FORUMS.READ_ONLY_POST" ng-if="vm.forum.readOnly && !vm.canEdit(vm.forum)"></h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-responsive table-category">
            <table class="table table-hover table-valign-middle">
                <thead>
                    <tr>
                        <th>{{'FORUMS.FIELDS.TOPICS' | translate}}</th>
                        <th class="text-center xs-hide">{{'FORUMS.FIELDS.REPLIES' | translate}}</th>
                        <th class="text-center xs-hide">{{'FORUMS.FIELDS.VIEWS' | translate}}</th>
                        <th class="text-center xs-hide sm-hide">{{'FORUMS.FIELDS.LAST_REPLY' | translate}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="t in vm.topics">
                        <td>
                            <span class="post-icon glyphicon glyphicon-eye-open" ng-class="{'has-new-reply': vm.hasNewReply(t)}"></span>

                            <div class="post-info">
                                <p class="topic-title">
                                    <i class="fa fa-arrow-circle-up fa-lg text-primary" aria-hidden="true"
                                       title="{{'FORUMS.TITLES.TOPIC_TOP_TOPIC' | translate}}"
                                       ng-if="t.isTop"></i>
                                    <a ui-sref="forums.topic({ forumId: vm.forum._id, topicId: t._id })">{{t.title}}</a>
                                    <small class="badge badge_default" ng-show="t.readOnly">R</small>
                                </p>

                                <p class="topic-by small"
                                   translate="FORUMS.FIELDS.POST_BY"
                                   translate-values="{user: t.user.displayName, createdAt: '{{t.createdAt | date: 'yyyy-MM-dd HH:mm:ss'}}' }">
                                </p>
                            </div>
                        </td>
                        <td class="text-center xs-hide"><span class="count-number">{{t.replyCount}}</span></td>
                        <td class="text-center xs-hide"><span class="count-number">{{t.viewCount}}</span></td>
                        <td class="xs-hide sm-hide">
                            <div class="small reply-by">
                                <span translate="FORUMS.FIELDS.REPLY_BY_1"
                                      translate-values="{user: t.user.displayName}"></span>
                                <span message-to="t.user" to-class="message-to-icon"></span>
                            </div>
                            <div class="small reply-by"
                                 ng-if="t._replies.length > 0"
                                 translate="FORUMS.FIELDS.REPLY_BY_2"
                                 translate-values="{createdAt: '{{t.lastReplyAt | date: 'yyyy-MM-dd HH:mm:ss'}}'}">
                            </div>
                            <div class="small reply-by"
                                 ng-if="t._replies.length == 0"
                                 translate="FORUMS.FIELDS.REPLY_BY_3"
                                 translate-values="{createdAt: '{{t.createdAt | date: 'yyyy-MM-dd HH:mm:ss'}}'}">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>